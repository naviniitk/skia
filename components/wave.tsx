import { Canvas, Fill, Group, Path, Skia } from '@shopify/react-native-skia'
import { useEffect } from 'react'
import {
  useDerivedValue,
  useSharedValue,
  withRepeat,
  withTiming,
} from 'react-native-reanimated'
import { useWindowDimensions } from 'react-native'

const path1 =
  'M0 722L12.8 714.7C25.7 707.3 51.3 692.7 77 679C102.7 665.3 128.3 652.7 154 672.7C179.7 692.7 205.3 745.3 231.2 748.2C257 751 283 704 308.8 672.2C334.7 640.3 360.3 623.7 386 651.5C411.7 679.3 437.3 751.7 463 773.8C488.7 796 514.3 768 527.2 754L540 740L540 961L527.2 961C514.3 961 488.7 961 463 961C437.3 961 411.7 961 386 961C360.3 961 334.7 961 308.8 961C283 961 257 961 231.2 961C205.3 961 179.7 961 154 961C128.3 961 102.7 961 77 961C51.3 961 25.7 961 12.8 961L0 961Z'
const path2 =
  'M0 788L12.8 775.5C25.7 763 51.3 738 77 711C102.7 684 128.3 655 154 664C179.7 673 205.3 720 231.2 724.3C257 728.7 283 690.3 308.8 670.8C334.7 651.3 360.3 650.7 386 664.5C411.7 678.3 437.3 706.7 463 713C488.7 719.3 514.3 703.7 527.2 695.8L540 688L540 961L527.2 961C514.3 961 488.7 961 463 961C437.3 961 411.7 961 386 961C360.3 961 334.7 961 308.8 961C283 961 257 961 231.2 961C205.3 961 179.7 961 154 961C128.3 961 102.7 961 77 961C51.3 961 25.7 961 12.8 961L0 961Z'

const path3 =
  'M0 691L4.5 681.3C9 671.7 18 652.3 27 660.2C36 668 45 703 54 733.2C63 763.3 72 788.7 81 781.8C90 775 99 736 108 707C117 678 126 659 135 660.5C144 662 153 684 162 701C171 718 180 730 189 744.3C198 758.7 207 775.3 216 743.7C225 712 234 632 243 594.5C252 557 261 562 270 582.5C279 603 288 639 297 634.5C306 630 315 585 324 582.8C333 580.7 342 621.3 351 663.5C360 705.7 369 749.3 378 759.5C387 769.7 396 746.3 405 725.8C414 705.3 423 687.7 432 664.2C441 640.7 450 611.3 459 626.5C468 641.7 477 701.3 486 694.7C495 688 504 615 513 592.7C522 570.3 531 598.7 535.5 612.8L540 627L540 961L535.5 961C531 961 522 961 513 961C504 961 495 961 486 961C477 961 468 961 459 961C450 961 441 961 432 961C423 961 414 961 405 961C396 961 387 961 378 961C369 961 360 961 351 961C342 961 333 961 324 961C315 961 306 961 297 961C288 961 279 961 270 961C261 961 252 961 243 961C234 961 225 961 216 961C207 961 198 961 189 961C180 961 171 961 162 961C153 961 144 961 135 961C126 961 117 961 108 961C99 961 90 961 81 961C72 961 63 961 54 961C45 961 36 961 27 961C18 961 9 961 4.5 961L0 961Z'

export default function Wave() {
  const progress = useSharedValue(0)
  const { width, height } = useWindowDimensions()
  const animatedPath = useDerivedValue(() => {
    const path = Skia.Path.Make()
    path.addPath(Skia.Path.MakeFromSVGString(path1)!)

    return path.interpolate(
      Skia.Path.MakeFromSVGString(path2)!,
      progress.value
    )!
  }, [progress])

  useEffect(() => {
    progress.value = withRepeat(withTiming(1, { duration: 1000 }), -1, true)
  }, [progress])

  return (
    <Canvas style={{ flex: 1 }}>
      <Group transform={[{ translate: [0, -height / 2] }]} clip={animatedPath}>
        {/* <Fill /> */}
        <Path path={animatedPath} color="#FA7268" style='stroke' strokeWidth={10} />
      </Group>
    </Canvas>
  )
}
